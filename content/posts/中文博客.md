---
author: 陈璐
title: 测试中文
date: 2021-12-21
description: 中文样式测试
math: false
ShowBreadCrumbs: true
tags: ["first", "zh"]
---

## 云原生技术概述

什么是云原生？为什么它将是软件开发的未来形态？

### 云原生——软件行业的“集装箱革命”

- “集装箱”的出现是实体货物包装，运输，交付方式的一场革命。
  - “没有集装箱，不可能有全球化”——经济学家杂志
  - 经济全球化的基础是一个高效（低成本，低复杂性，自动化）的全球运输系统，集装箱是这个系统的核心。
  - 这个系统不仅仅包括集装箱本身，还包括围绕着标准化的集装箱打造的一整套货物流转的新方法以及与之配套的基础设施。包括港口，公路，桥梁，隧道，货船，起重机，卡车以及发货人的操作方式。
- 集装箱让全世界的物流运输业使用一种“语言”，一套标准；标准化与系统化的运输系统，极大地降低了货物运输的成本，降低了货物在全球流转的门槛。**重要的不是集装箱，而是围绕集装箱打造的一套标准化、系统化的方案。**
- 云原生对 IT 领域的意义就像集装箱，只是其中承载的不再是实体货物，而是虚拟世界的二进制代码和软件。

### 软件开发模式的演进

聚焦于后端开发领域

- 单体应用
  - 课程项目，一个庞大的后端，MVC 范式, 存在 module 但是 module 之间强耦合（无法独立存在）
  - 初期易于开发，测试，维护；随着需求的扩增以及开发团队的变更，代码库变得臃肿，维护成本高。**扩展性差**。
- 分布式应用
  - 单体应用（单台机器）难以适应日益增长的用户需求访问，需要将一个庞大的系统拆分成不同的业务模块，部署到不同的机器，各个业务模块通过事先约定的接口进行网络通信。数据库使用分布式数据库 TiDB 代替传统的数据库 MySQL。通过一个反向代理服务器 Nginx 代理用户请求，把请求压力分摊到多台机器上。
  - 提升了负载能力，解决了高并发需求。伸缩性差，运维成本高；模块间通信成本高。
- 微服务架构
  - Docker 为代表的容器技术诞生，将物理机级别的分布式提升到容器级别的分布式。
  - 物理级别分布式的潜在问题，多服务（一组进程）共享同一机器时产生的资源竞争问题，安全性问题。
  - 容器技术让各个服务运行在抽象的容器中，共享同一台物理机的资源的同时相互隔离，互不干扰。容器技术相比于传统的虚拟机技术性能损失小，启动快。
  - K8s 管理一组容器（集群）的平台。监控容器运行状态自动重启，管理容器间的网络通信进行网络代理，自动伸缩动态调度资源。
  - [Service Mesh](https://zhuanlan.zhihu.com/p/61901608)，接管微服务中的分布式通信模块，K8s 生态中的网络管理插件。
- 总结
  - 简单的事情变复杂（模块间函数调用需要依靠 RPC 网络参与，出现了网络可靠性，服务发现，网络延迟等相关问题），复杂的事情变简单（用户原本只是先写一个模块间的函数调用罢了，用户只需要也只应该关注业务开发而不是把开发和运维搅在一起）
  - 应用与“云”技术结合越来越紧密。从与云完全无关（单体应用）到云服务器，云数据库；到基于云的微服务架构。

### 云原生概念的提出

> 云原生是指从云的原生应用角度出发，一整套设计、开发、部署、运行、维护的流程、技术栈以及背后文化理念的统称。

**![](https://lh4.googleusercontent.com/i8OfIhamrOb-NTylDhzon3iZ0KNaUyYs0tZ9lr2ezlzIyCzrMhN1qiExCji1Xql9kW5Yqk-1n4MXaed5N1Mqb_0J01LzsNobAMumthdT2LjBG1jdzQER98EnElQBwwd7xE7iseZa3y8)**

围绕着云进行软件开发的一套**标准化、系统化**的方案。云原生应用天然具备弹性扩展，快速迭代交付，开发成本低等优势；另外分布式带来的运维成本正在被云原生社区活跃的新方案逐步解决。

### 云原生技术特点

一个更直观的对比与感受。

## 边缘计算 + 云原生 = 边缘云原生

边缘计算的特点？为什么云原生技术会和边缘计算产生联系？要实现“边缘云原生”有哪些挑战？

### 云时代下的边缘计算场景

- 边缘计算简述
  - 边缘指的是网络的边缘，一定程度上与云计算是一个相对的概念
  - 越靠近云（数据中心）算力越强，越靠近边缘延迟越低
  - 边缘计算的必要性：网络成本（视频，图像），网络不确定，及时性（自动驾驶），隐私（人脸，声音）
- 边缘计算不仅仅只是在边缘发生计算，还需要与云计算协同
  - 一个“人脸识别”案例（云训练迭代，边部署推理）
    - 1.0 模型分发部署（云->边）
    - 边缘推理预测，上报预测结果（边->云）
    - 模型训练迭代（云）
    - 2.0 模型分发部署 （闭环）

### 云时代下的边缘计算特点

- 边缘是云的延伸
  - 计算资源/设备位于边缘，注册上报云端统一管理
  - 应用由云端统一部署
- 云-边双向通信
  - 边缘设备复杂网络环境（不稳定，私有网络，防火墙隔断）
  - 边缘设备分散，海量
- 云-边松耦合
  - 边缘自治，不依赖于云端（甚至在断网环境）可靠地完成本地任务
  - 边缘节点之间能够在局域网内互相感知，通信
- 节点、设备异构
  - 有限计算资源
  - 异构硬件架构
  - 异构网络协议（物联网中行业内通信协议）

### 从云原生到边缘云原生

- 从云原生的视角审视边缘计算，很多问题是现有云技术已经解决的问题
  - 大量设备的统一交付，运维，部署。（节点在云上，节点在边缘）
  - 异构资源的管理，轻量化的容器化技术。
- 云原生本身标准统一，社区繁荣，k8s 适合二次开发。
- 借助云原生现有技术，实现“云-边”一体化
- 如何将云原生现有技术应用到边缘计算中？

### 传统云原生的解法——K8s

简单介绍 K8s 的功能，特点。

- K8s 是云原生技术体系的中的“操作系统”，它的 API 已经是云原生社区事实上的标准。
- 与其说是一个管理容器的工具，更像是一个可定制可拓展的平台，形成了繁荣的生态。
- 功能案例
  - 自动修复： Kubernetes 会重启失败的容器，替换容器，杀死不响应用户定义的健康检查的容器，并且在它们准备好服务之前不会将它们通告给客户端。
  - 负载平衡： 当一个容器的流量比较大时，Kubernetes 能够对网络流量进行负载均衡和分配，从而保证整个集群的稳定性。
  - 自动 rollout 和 rollback：您可以自动化 Kubernetes 为您的部署创建新容器、删除现有容器并将其所有资源用于新容器。新功能的灰度更新，生产环境版本回滚。
- 架构 主从 Master-Slave
  - Master
    - etcd: 集群信息数据库（保证访问一致性，高可用）
    - API Server: Master 与 Node 交互的前端，暴漏所有的 API（可已有多个 API Server Instance 防止过载）
    - Scheduler: 根据软硬件环境，调度节点上的容器资源
    - Controller: 监控节点状态，管理节点任务
  - Node（每个 Node 是一台机器）
    - Network Proxy: 代理节点的网络通信（节点间通信，节点与 Master 的通信)
    - Kubelet: 管理节点上所有 K8s 集群中的运行容器
    - Container Runtime: Docker 或者其他容器运行时

### 边缘云原生的技术挑战

K8s 是为数据中心设计的，对集群运行环境有一些预设和假定不适合边缘计算环境。

- 边缘离线自治能力的缺失（Node 节点失去 Master 联系后不工作）
- 边缘网络环境的不确定性（List-Watch 机制：全量获取，增量更新，网络频繁断接情况下损耗大）
- 边缘计算资源的有限性（有必要对 Node 的不必要功能组件进行裁剪？减少不必要的资源消耗）

## 一个边缘云原生解决方案——SuperEdge

### SuperEdge 整体架构

SuperEdge 是一个基于 K8s 现有功能，无侵入式二次开发的边缘云原生解决方案。

- 无侵入式，套壳（直接以 mod 引入的方式，没有改动一行代码，优势在于升级维护难度小）
- 断网情况下的边缘自治（边缘节点不依赖于与 Master 的联系，可以自主运行）
- 复杂网络下的云边协同（边缘节点没有公网 IP 情况下，也能双向通信）
- 边缘节点分布式健康检查（边缘节点的状态不仅由其于 Master 的联系确定，而且由与其一组的边缘节点组内的联系确定）
- ServiceGroup 服务级别的控制（添加了一个 ServiceGroup 级别的控制层次便于管理不同的边缘集群）

### SuperEdge - Edge

### SuperEdge - Cloud

## 总结
